plugins {
	id 'java'
	id 'io.spring.dependency-management'
	id 'org.anarres.jnaerator'
}

repositories {
	mavenLocal()
	maven {
		url 'https://repo.springsource.org/release/'
		url 'https://plugins.gradle.org/m2/'
	}
	jcenter()
	mavenCentral()
}

sourceCompatibility = JavaVersion.VERSION_14
targetCompatibility = JavaVersion.VERSION_14

dependencies {
	implementation project(':viperpit-commons')
	runtimeOnly project(':viperpit-web')
	implementation 'com.google.guava:guava:27.1-jre'
	implementation 'ch.qos.logback:logback-classic'
	implementation 'net.java.dev.jna:jna:5.5.0'
	implementation 'net.java.dev.jna:jna-platform:5.5.0'
	implementation 'org.springframework.boot:spring-boot-starter-cache'
	implementation 'org.springframework.boot:spring-boot-starter-jetty'
	implementation('org.springframework.boot:spring-boot-starter-web') {
		exclude module: 'spring-boot-starter-tomcat'
	}
	implementation('org.springframework.boot:spring-boot-starter-websocket') {
		exclude module: 'spring-boot-starter-tomcat'
	}
	testImplementation 'org.springframework.boot:spring-boot-starter-test'
}

sourceSets {
	main {
		java {
			srcDirs += ["src/main/java-gen"]
		}
	}
}

// Can be enabled when a new JNA Structure has to be generated from an updated header file.
jnaerator.enabled = false
jnaerator {
	libraryName 'FlightData'
	packageName 'de.viperpit.agent.data.jna'
	headerFiles "./headers/headers.jnaerator"
	outputDir file("./src/main/java-gen")
}