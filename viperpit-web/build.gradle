import com.moowork.gradle.node.task.NodeTask

buildscript {
	dependencies {
		classpath "com.moowork.gradle:gradle-node-plugin:1.2.0"
	}
}
apply plugin: "java"
apply plugin: "eclipse-wtp"
apply plugin: "com.moowork.node"

sourceCompatibility = 1.8
targetCompatibility = 1.8

sourceSets {
	main {
		resources {
			srcDirs "dist"
		}
	}
}

node {
	version = "8.4.0"
	npmVersion = "5.4.2"
	download = true
}

task npmRunBuild(type: NpmTask, dependsOn: "npmInstall") {
	args = ["run", "build"]
}
processResources.dependsOn "npmRunBuild"

task npmRunDev(type: NodeTask, dependsOn: "npmInstall") {
	script = file("webpack/dev-server.js")
}

clean.delete << file("node_modules")
clean.delete << file("dist")